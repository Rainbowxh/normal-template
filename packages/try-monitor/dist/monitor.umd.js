(function(h,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(h=typeof globalThis<"u"?globalThis:h||self,p(h.monitor={}))})(this,function(h){"use strict";var oe=Object.defineProperty;var re=(h,p,v)=>p in h?oe(h,p,{enumerable:!0,configurable:!0,writable:!0,value:v}):h[p]=v;var R=(h,p,v)=>re(h,typeof p!="symbol"?p+"":p,v);function p(){return document.elementsFromPoint?!0:(console.warn("browser do not support white screen check"),!1)}const v=(e={checkElements:[],debug:!0})=>{try{let i=function(){ee(()=>{(!document||!document.elementsFromPoint)&&console.warn("当前浏览器不支持白屏检测");let r=!0;const d=[...H,...M];for(let m=0;m<d.length;m++){const u=d[m],te=`point-${u[0]}-${u[1]}`,ne=document.elementsFromPoint(u[0],u[1]),O=[];for(let B of ne){const ie=s(B);if(O.push(ie),c(B)){r=!1,w&&n(T,u[0],u[1],"#00ff00");break}else w&&n(T,u[0],u[1],"#ff3300")}if(b[te]=O,!r&&!I)break}r?o():(S&&clearTimeout(S),L=0,U(b))})},t=function(){const r=document.createElement("canvas");document.body.appendChild(r),T=r.getContext("2d"),r.width=window.innerWidth,r.height=window.innerHeight,r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.zIndex="9999",r.style.pointerEvents="none",H.forEach(d=>n(T,d[0],d[1])),M.forEach(d=>n(T,d[0],d[1]))},n=function(r,d,m,u){r.clearRect(d-10,m-10,20,20),r.beginPath(),r.arc(d,m,10,0,2*Math.PI),u&&(r.fillStyle=u),r.fill()},o=function(){L===0&&(Z(b),console.error("now is whiteScreen")),S&&clearTimeout(S),S=setTimeout(()=>{L--,i()},1e3)},c=function(r){const d=s(r);let m=!1;for(let u=0;u<g.length;u++)if(d.match(g[u])){m=!0;break}return m},s=function(r){return r.id?`#${r.id}`:r.className&&typeof r.className=="string"?`.${r.className.split(" ").filter(d=>!!d).join(".")}`:r.nodeName.toLowerCase()},l=function(){const r=document.readyState;f||r==="complete"?i():window.addEventListener("load",i)};if(!p())return!1;const{debug:w=!0,checkPointsNum:y=17,isSkeleton:f=!1,loop:F,checkAll:I=!1,checkList:g=["#app"],onSuccess:U=()=>{},onFail:Z=()=>{}}=e;let L=f?F:0,S=null;const W=Math.ceil(y/2);let H=[],M=[];const b={};b.checkList=g;let T=null;const N=()=>{const r=window.innerWidth/2,d=window.innerHeight/2;for(let m=1;m<W;m++)M.push([r,window.innerHeight*m/W]),H.push([window.innerWidth*m/W,d])},ee=r=>{requestIdleCallback?requestIdleCallback(r):setTimeout(()=>r,0)};N(),w&&t(),l()}catch(i){console.error("white screen check error",i)}};var a=(e=>(e.NT="navigation-timing",e.FP="first-paint",e.FCP="first-contentful-paint",e.LCP="largest-contentful-paint",e.CCP="custom-contentful-paint",e.FID="first-input-delay",e.RL="resource-flow",e.CLS="cumulative-layout-shift",e.FPS="fps",e.ACT="api-complete-time",e.TTFB="time-to-first-byte",e.DI="device-information",e.NI="network-information",e.PI="page-information",e))(a||{});let k=document.visibilityState==="hidden"?0:1/0;const P=(e,i)=>{var t;try{if((t=PerformanceObserver.supportedEntryTypes)!=null&&t.includes(e)){const n=new PerformanceObserver(o=>o.getEntries().map(c=>i(c)));return n.observe({type:e,buffered:!0}),n}}catch(n){throw n}},C=(e,i=!0)=>{const t=n=>{e(n),i&&(window.removeEventListener("pagehide",t),window.removeEventListener("visibilitychange",t))};window.addEventListener("pagehide",t),window.addEventListener("visibilitychange",t)},E=e=>{document.prerendering?document.addEventListener("prerenderingchange",e,{once:!0}):e()},D=()=>(C(e=>{k=Math.min(k,e.timeStamp)},!0),{get timeStamp(){return k}}),V=(e,i=!0)=>{window.addEventListener("click",e,{once:!0}),window.addEventListener("keydown",e,{once:!0})},$=()=>{const e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},j=(e,i)=>{let t={value:0,entries:[]};const n=s=>{s.hadRecentInput||(t.value+=s.value,t.entries.push(s))},o=P("layout-shift",n);C(()=>{if(o){o!=null&&o.takeRecords&&o.takeRecords().map(n),o==null||o.disconnect();const s={name:a.CLS,value:t.value,entires:t.entries};e.set(a.CLS,s),i(s)}})};function A(e,i){if(!window.performance)return;const t={name:a.DI,memory:window.performance.memory,eventCounts:window.performance.eventCounts,timing:window.performance.timing,navigation:window.performance.navigation,timeOrigin:window.performance.timeOrigin};return e.set(a.DI,t),i(t),t}function q(e,i){if(!window.PerformanceObserver)return;new Promise((n,o)=>{const s=P("paint",l=>{l.name===a.FCP&&(s&&s.disconnect(),n(l))})}).then(n=>{const o={name:a.FCP,time:n.startTime,entries:[n]};e.set(a.FCP,o),i(o)}).catch(n=>{console.log(n)})}const x=(e,i)=>{const t={name:a.FID,value:0,entries:[]},n=D();E(()=>{const o=l=>{l.startTime<n.timeStamp&&(t.value=l.processingStart-l.startTime,t.entries.push(l),e.set(t),i(t))},c=P("first-input",o);C(()=>{c&&(c.takeRecords&&c.takeRecords().forEach(o),c.disconnect())})})};function _(e,i){if(!window.PerformanceObserver)return;new Promise((n,o)=>{const s=P("paint",l=>{l.name===a.FP&&(s&&s.disconnect(),n(l))})}).then(n=>{const o={name:a.FP,time:n.startTime,entries:[n]};e.set(a.FP,o),i(o)}).catch(n=>{console.log(n)})}const z=(e,i)=>{const t={},n=D();E(()=>{const o=l=>{l.startTime<n.timeStamp&&(t.value=l)},c=P(a.LCP,o);let s=()=>{var w;if(!c)return;c.takeRecords&&c.takeRecords().forEach(o),c==null||c.disconnect();const l={name:a.LCP,value:(w=t.value)==null?void 0:w.startTime,entries:[t.value]};e.set(a.LCP,l),i(l),s=()=>{}};C(s),V(s)})};function X(e,i){var n;if(!((n=window.navigator)!=null&&n.connection))return;const t=window.navigator.connection;return t.name=a.NT,e.set(a.NT,t),i(t),t}function Y(e,i){const{host:t,hostname:n,href:o,protocol:c,origin:s,port:l,pathname:w,search:y,hash:f}=location,{width:F,height:I}=window.screen,g={name:a.PI,width:F,height:I,host:t,hostname:n,href:o,protocol:c,origin:s,port:l,pathname:w,search:y,hash:f};return e.set(a.PI,g),i(g),g}const G=(e,i)=>{let t={name:a.TTFB};E(()=>{const n=$();n&&(t.entries=[n],t.value=Math.max(n.responseStart-n.activationStart,0),e.set(a.TTFB,t),i(t))})};let J=class{constructor(){R(this,"state");this.state=new Map}set(i,t){this.state.set(i,t)}get(i){return this.state.get(i)}has(i){return this.state.has(i)}clear(){this.state.clear()}getValues(){return Array.from(this.state).reduce((i,[t,n])=>(i[t]=n,i),{})}};console.log("this is sth");let K;class Q{constructor(i){R(this,"immediately");const{appId:t,version:n,reportCallback:o,immediately:c=!1,isCustomEvent:s=!1,logFpsCount:l=5,excludeRemotePath:w=[],scoreConfig:y={}}=i;this.immediately=c;const f=new J;Y(f,o),X(f,o),A(f,o),z(f,o),j(f,o),G(f,o),x(f,o),window.addEventListener("pageshow",()=>{_(f,o),q(f,o)})}getCurrentMetrics(){return K.getValues()}}h.WebVitals=Q,h.whiteScreenCheck=v,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
